<form hx-post="/messages/send/"
      hx-target="#messages-container"
      hx-swap="none"
      hx-on::after-request="this.reset();"
      class="flex items-center gap-2">
      {% csrf_token %}
    <input type="hidden" name="conversa_id" value="{{ conversa.id }}">

    <input type="text" name="mensagem"
           class="flex-1 border-none rounded-lg py-2 px-4 focus:ring-0 bg-white shadow-sm"
           placeholder="Digite uma mensagem..."
           autocomplete="off"
           required />

    <button type="submit" class="bg-[#00a884] hover:bg-[#008f6f] text-white p-2 rounded-full shadow-sm transition-colors flex items-center justify-center w-10 h-10">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
            <path d="M1.101 21.757 23.8 12.028 1.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"></path>
        </svg>
    </button>
</form>

<script>
    // Hack simples para garantir scroll após envio HTMX, caso o hx-swap não role automaticamente
    document.body.addEventListener('htmx:afterSwap', function(evt) {
        if(evt.detail.target.id === "messages-container") {
            evt.detail.target.scrollTop = evt.detail.target.scrollHeight;
        }
    });
</script>